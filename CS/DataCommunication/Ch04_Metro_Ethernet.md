# 01 MAN의 개요

## ✅ MAN의 정의

> [!NOTE]
>
> **MAN: Metropolitan Area Network**
>
> **도시 지역 규모의 네트워크를 연결하는 네트워크 유형**
>
> - 대도시에 있는 가입자(기업, 가정)망 연결
> - **백본망과 가입자 망 접속 제공**
> - LAN보다 넓은 범위, WAN보다 작은 범위

- LAN과 LAN을 연결
- **백본 네트워크로 가는 길목** 역할
- NPE(Network Provider Edge): 네트워크 공급자 edge
- CE-PE: 고객 에지-공급자 edge 인터페이스
- NP: 네트워크 공급자
- 6PE: IPv6 제공자 edge
- CPE(Customer Premises Equipment): 고객 소유 부지 내 장비(단말기, 모뎀 등 고객 또는 사업자에게 대여받아 고객 소유 장비)

## ✅ MAN Topology

### ✔️ DQDB (Distributed Queue Dual Bus; 분산 큐 이중 버스 구조)

- 다수의 LAN 간 통신(LAN 상호 연결)을 원활히 하기 위한 기술
- 2중 버스 구조, 링 구조 → 국내 MAN 구간은 링형 구조로 구광케이블이나 동축 케이블 이용
- ⭐ **회선 교환 및 패킷 교환 서비스 모두 제공**
  - 회선교환방식: 전용 통신 경로를 설정한 후 데이터 전송하는 방식
    - 처음부터 끝까지 하나의 **고정된 경로** 사용 → 데이터 **안정적 전송**
  - 패킷교환방식: 데이터를 작은 패킷으로 나눠 **다양한 경로**를 통해 전송하고, 목적지에서 다시 조립하는 방식 → 효율적이고 유연하게 데이터 전송
  - 회선교환의 실시간성, 안정성 + 패킷 교환의 유연성을 통합
- 슬롯 생성기: 이중 버스 구조를 갖는 DQDB에서 버스의 양쪽 시작 부분에 53바이트 슬롯을 주기적으로 생성

### 기존 버스 구조의 문제점

- **정해진 스트림 방향으로만 데이터를 전송**
- 각 버스의 시작 노드(슬롯 생성기)에서 빈 프레임 슬롯 생성
- 각 노드는 빈 프레임을 받았을 때만 전송 가능
  - 기아(Starvation) 현상: 앞 노드들이 슬롯을 계속 사용하면 → **마지막 노드**는 전송기회 갖지 못할 가능성이 높아짐

### 분산 큐 구조를 통한 버스 구조 문제점 해결

기아 현상 방지를 위해 고안 (**전송 순서 예약**)

- 각 노드는 연결된 버스당 하나씩 큐 생성
- 버스를 지나는 슬롯 내의 예약정보가 오면 큐에 삽입
- 자신이 데이터를 전송하고자 할 때 큐에 삽입
- 지나가는 슬롯에 예약정보를 삽입
- 자신의 슬롯을 전송하기 전 다른 노드를 위한 슬롯이 몇개인지 파악 가능
- 예약은 반대편 버스를 통해 수행

### DQDB > 링형 구조

- 실제 구축되어 있는 MAN은 두 개의 망으로 구성
  - Metro Access(메트로 액세스): 가입자
  - Metro Core: 망 제공자 → 메트로 액세스와 다른 메트로 액세스 네트워크 간 연결 기능과 백본 네트워크 연결 가능

### ✔️ DQDB의 프레임

- B(Busy): **슬롯 내부에 데이터의 유무**
- ST(Slot Type): 전송 슬롯의 두 가지 유형
- R(Reservation): **슬롯을 예약**하기 위해 사용하는 비트
- PSR(Previous Slot Read): 슬롯을 이전 노드가 읽었는지 여부 (슬롯을 읽은 노드에 의해 0으로 변경)
- RQ(ReQuest): 3개의 비트를 이용해 **전송 우선권**을 구분 → 각 노드에서 예약을 할 때 설정
- Address: MAN과 WAN에 사용되는 가상 채널 식별자
- Priority: 전송 우선순위를 명시
- CRC(Cyclic Redundancy Check): 에러검출용 순환중복검사
  - 데이터를 전송할 때 전송된 데이터에 오류가 있는지 확인하기 위한 체크 값을 결정하는 방식
  - 순방향 에러 정정(FEC) 사용 → 데이터 전송 전 데이터값에 따라 CRC 값 계산해서 데이터에 붙여 전송하고, 데이터 전송 끝난 후 받은 데이터값으로 CRC값 계산, 이어 두 값을 비교하고 두 값이 다르다면 데이터 전송 과정에서 오류가 있는 것 확인 가능

## ✅ SMDS; **Switched Multimegabit Data Service**

> [!NOTE]
>
> DQDB를 바탕으로 개발된 고속의 비연결형 데이터 전송 프로토콜
>
> **LAN, MAN, WAN을 연결하여 → 고속 통신을 지원하는 비연결형 서비스**
>
> - **스위칭 시스템 → 효율적으로 데이터 전송**
> - **TDM 방식을 사용하지 않음**

- 비연결형 서비스: 일단 데이터를 보내고 끝내는 방식. 따로 연결 상태를 유지할 필요가 없는 고속 통신 방법
- 스위칭: 데이터가 최적의 경로로 빠르게 전달되도록 하는 방식
  - TDM(Time Division Multiplexing): 시간을 나누어 여러 신호를 전송하는 방식
- 가입자는 CPE(Customer Premises Equipment)(라우터) 보유

<br />

# 02 현대의 MAN

## ✅ MAN의 구성

### ✔️ ATM 구성

(Asynchronous Transfer Mode; 비동기 전달 모드): **각 데이터를 셀 형태로 변환**(패킷 교환방식), 여분 대역폭을 효율적으로 할당 → 대역폭의 낭비를 줄일 수 있음

- cf. 동기식 TDM(시분할 다중화) 방식 사용: 동일한 시간 간격으로 전송 → 전송 데이터가 없는 경우에도 대역이 할당되어 대역폭의 낭비가 초래
- **회선교환의 실시간성, 안정성 + 패킷 교환의 유연성을 통합**시킨 → 연결 지향적 패킷 교환 복합기술
  - 주소 포맷, 신호방식 등 → **회선 교환방식** 이용
  - ATM 셀 처리 등 → **패킷 교환방식** 이용
    - ATM 셀 총 53byte = 사용자 정보 데이터(Payload) 48byte + 전송 시 필요한 제어 정보를 포함하는 헤더 5byte로 구성
- B-ISDN(광대역 종합 정보 통신망)

### ✔️ SONET/SDH 링으로 구성

SONET/SDH: **광통신**에서 데이터를 전송하기 위한 **표준 프로토콜 (광 선로를 기반으로 하는 고속통신 지원)**

- 광섬유 케이블을 사용해 데이터를 고속으로 전송, 동기식 전송, 대용량 데이터 전송
- SONET(Synchronous Optical Network): **동기식 광통신망** (미국의 표준)
- SDH(Synchronous Digital Hierachy): **동기식 디지털 계층** (유럽의 표준)

---

- SONET 이중 링 구조: 데이터 전송용, 예비 데이터 전송용(보호용)
- MAN에서 **ADM(Add/Drop Multiplexer)** 사용 → 데이터를 네트워크에서 추가,제거하는 장비
  - 링 구조에서 **특정 지점에서 데이터를 쉽게 넣고 빼는 기능** → 데이터 흐름 효율적 관리
  - **장애 발생 시** 데이터를 다른 경로로 보내는 **복구 기능** 제공

## ✅ MAN의 역할

- **가입자망을 백본망으로 연결**해줌
- 모든 트래픽이 백본을 거치는 것을 방지 → 백본망의 활용도 상승

## ✅ MAN의 장단점

- ✨ **빠른 장애 복구 능력**
  - **ADM**이 장애를 감지하고 빠르게 데이터 전송경로 변경
- 💩 **TDM 기반의 SONET/SDH 회선 교환망**
- 💩 **인터넷 서비스 사업 형태 변화**, 멀티미디어 발달 → 가입자망 트래픽 폭증
  - MAN은 **가입자망과 백본망 사이에서 병목 현상 유발** → 전체적인 망 효율 저하
  - 인터넷 서비스 사업 형태 변화: 집중화된 서버 모델 → 분산 모델 전환

<br />

# 03 메트로 이더넷(Metro Ethernet)

기존의 LAN 영역에서 사용되던 **이더넷 기술을** **대도시권 영역에 확대 적용**한 기술

- **ISP(Internet Service Provider) 망과 가입자 망을 이더넷으로 연결** → 광케이블을 통해 직접 연결해 적**은 비용으로 고속 데이터 서비스** 제공
- 기존의 **MAN 문제점 해결**

## ✅ 메트로 이더넷의 특징

- 이더넷
  - 오랜 기간 걸친 기술 → 신뢰성O, 관리 인력 풍부, 다수의 개발회사 및 장비
- 패킷 교환 방식
  - **일정량의 대역폭을 점유하지 않는** 패킷 교환 방식
  - TDM에 비해 더 많은 가입자 수용 가능
  - 가입자별로 다양한 대역폭 지원 가능
- **VLAN(Virtual LAN)**
  - 2계층(Data Link Layer) 상에서 유연한 망을 구성할 수 있는 **가상 LAN**
  - **물리적인 배선 구성에 제한받지 않음**
  - 네트워크 구성 단말의 **추가, 삭제, 변경이 용이**
  - 물리적으로 떨어져 있는 노드들을 그룹 단위로 묶을 수 있음
- VPN(Virtual Private Network)
  - 실제 사설망이 아닌, **공중망을 이용한 가상 사설망**
  - VLAN을 통한 VPN 구축 → 기존 프로토콜 변경 요구됨
  - MPLS를 이용한 VPN 구축 → Label을 이용해 VLAN 한계 극복

## ✅ 메트로 이더넷의 구성

- 그물형 또는 링형
  - 2계층 또는 3계층 스위치를 이용해 각 CO(Central Office; 전화국)들을 연결
- 완전 그물형 구조
  - 가입자들은 CPE(Customer Premises Equipment; 고객소유 장비)에서 CO(전화국)의 위치를 데이터로 전송
  - 각 스위치는 2계층(Data Link Layer) 주소를 검사
  - 해당 목적지로 전송
    - 인터넷으로 보내야 할 프레임들은 인터넷 접속점(POP; Ponit of Presence)으로 전송되고, 그렇지 않은 프레임들은 해당 CO(전화국)에게 전달됨

## ✅ 메트로 이더넷의 기능

### ✔️ 패킷 분류화, QoS

- **모든 패킷에 대해 서비스 등급을 부여, 등급별 서비스 품질 차등화**
  - `Diff-Serv(Diffferentiated Service)` - 차등형 서비스
  - 우선순위가 높은 패킷에게 더 나은 서비스
  - DSCP(Differentiated Service Code Point) → Diff-Serv에서는 모든 IP 헤더에 DSCP를 붙임 → 차등 서비스의 종류와 등급 표시
  - **포트 유입을 제어** → 가입자와 서비스 제공자 간 **계약에 따른** 전송 **최대 대역폭 제한** 서비스
    - 트래픽 증가해서 규정된 대역폭 할당이 어려워져도, 높은 수준의 서비스는 본래의 대역폭을 최대한 보장받음(QoS 보장)
- ⭐ **QoS(통신서비스품질)을 보장**하는 네트워크로 발전
  - QoS: 통신에서 예측 가능하고 보장되어야 하는 최소한의 서비스 품질 요구사항
  - **통합형 서비스; Int-Serv(Integrated Service)**로 QoS 보장
    - Int-Serv 모델에서 정의한 서비스 유형 분류:
      - Best-Effort Service (최선형 서비스): 최선을 다하지만 확실한 전송 보장은 하지 않음
      - Controlled-Load Service (부하 제어형 서비스): 유연한 응용 지원, 보다 나은 서비스 지원
  - **자원 예약 모델**(사전에 자원 예약하는 방식)으로 QoS 보장

### ✔️ MPLS 사용

**다중 프로토콜 라벨 스위칭; MPLS(Multi Protocol Label Swithing)** 사용

- 대량의 트래픽 처리를 고속으로 처리하기 위한 방법
- 💩 기존 라우팅은 매 패킷마다 라우팅 테이블 참조, 헤더 검사를 반복 수행하여 라우팅 자원을 소모해 고속화가 어려웠지만, → ✨ 입구/출구에서 **단 한번만 라우팅을 수행**해 단 한번만 헤더를 조사하고, 자원 소모를 줄임

### ✔️ 네트워크 복구 능력

RPR(Resilient Packet Ring)에서의 망 복구

- WAN과 MAN에서의 패킷 스위칭을 향상시키기 위해 유동성, 효율성, 신뢰성을 이더넷에 접목
- RPR 기술은 이더넷 망을 Core Router를 통해 링 형태로 운용할 수 있도록 함
- 스티어링 → 의무적으로 구현
  - 절단 사실 인지하고 다른 코어 라우터에게 토폴로지 변경 요청
  - 전체 망의 토폴로지 변경 이전까지 전송된 데이터는 복구 가능성 보장 못함
- 랩백 → 선택적으로 구현
  - 절단 사실을 인지하자마자 해당 라우터는 다른 링을 통해 경로 변경
  - 전송 중단 없이 데이터 전송 가능
