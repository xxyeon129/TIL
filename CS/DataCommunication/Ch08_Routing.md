> [!NOTE]
>
> 라우팅: 패킷의 전달 경로 설정

<br />

# Ch08 Routing

<aside>
💡

라우팅: 패킷의 전달 경로 설정

</aside>

# 01 라우팅 개요

**라우팅:** 정보를 목적지까지 전송하기 위해 / 가장 효과적인 전송방법을 결정하는 것

- 인접한 라우터들의 **네트워크 정보와 metric값**을 받아서 → **최적의 경로를 선택**하여 **목적지까지 패킷을 전송**할 수 있게 하는 기능 (metric: 최적의 경로를 설정하는 값)
- 패킷을 전송하기 위해 송신측에서 **목적지까지의 경로를 정하고**, **정해진 경로를 따라 패킷을 전달하는 일련의 과정**
- 패킷을 전송하기 위한 **수많은 경로 중 한 가지 경로를 결정**하는 것
- **`라우팅 테이블`:** 라우팅을 위해 네트워크 상의 모든 라우터들은 **목적지에 따라** **패킷을 보낼 interface를 먼저 계산**해 놓아야 하는데, **이를 계산해놓은 것**

## ✅ Routed Protocol

- 라우팅을 당하는 = 라우터가 라우팅해주는 고객
- TCP/IP, Novel IPX, Apple Talk…

## ✅ Routing Protocol

**라우터 내부**에서 라우팅 알고리즘을 수행하는 프로토콜

- **RIP(Routing Information Protocol: 거리 벡터),**
- **IGRP(Interior Gateway Routing Protocol: 내부 게이트웨이 프로토콜),**
- EIGRP(Enhanced Interior Gateway Routing Protocol),
- OSPF(Open Shortest Path First),
- BGP(BorderGatewayProtocol),EGP(ExteriorGatewayProtocol),
- ES-IS(EndSystemtoIntermediateSystem),
- IS-IS(IntermediateSystemtoIntermediateSystem)

## ✅ 라우팅을 하기 위한 라우터의 역할

1️⃣ 경로 정보 수집 → 2️⃣ 라우팅 프로토콜 적용 → 3️⃣ 라우팅 광고 → 4️⃣ 라우팅 테이블 생성

- **인접한 라우터로부터 정보를 수집**
- 수집한 정보를 가지고 → 목적지로 가기 위해 **어떤 경로를 통해 패킷을 전달**할 수 있는지 판단하여 **라우팅 테이블을 만듦**

## ✅ 정보 전달 수행 절차

호스트가 TELNET으로 서버 접속 시 수행 절차

1️⃣ 주소 인식 → 2️⃣ 라우팅 테이블 검색 → 3️⃣ 최적의 경로 설정 → 4️⃣ 패킷 전달

## ✅ 경로 결정 요소 Metric

라우터는 인접한 라우터로부터 전달 받은 경로 정보로 **비용**을 계산해 → 최적의 경로를 설정

→ 이 **비용을 계산하는데 영향**을 미치는 요소가 **Metric**

- 라우터는 Metric을 사용하여 / 경로결정 요소들의 상태를 → 수치로 표현하여 계산 → 이 값을 **비용(Cost)**이라 함
- **관리자가 선택한 라우팅 프로토콜**에 따라 / 경로결정 요소들의 **우선순위**가 반영
  - 일반적으로 **가장 적은 비용의 경로**를 최적의 경로로 결정
- 홉 수(Hop Count), 대역폭(Bandwidth), 지연(Delay), 신뢰도(Reliability), 부하(Load) 등

### 1️⃣ 홉 수(Hop Count)

- 하나의 홉 == 하나의 라우터를 지나가는 것
- 라우터를 지날 때마다 **지연**이 발생 → 거쳐가는 **라우터 수가 적은 경로 (홉 수가 적은 경로)**로 패킷을 전달하는 것이 빠르고 안정적
- 라우터와 라우터가 직접 연결 되어 있을 때 거리를 1홉이라고 함 (본인 제외 라우터개수)

### 2️⃣ 대역폭 (Bandwidth)

- 링크의 대역폭 == 전송 매체 간의 **전송능력**
- 대역폭이 **넓은** 링크가 → 전송속도가 빠른 최적의 경로

### 3️⃣ 지연 (Delay)

패킷을 목적지까지 전송하는 과정에서 발생한 **전송지연 시간**

- 네트워크의 링크의 회선 속도, 각 경로 당 라우터의 큐 길이, 링크의 네트워크 정체, 물리적 회선 거리 등 **많은 요인에 의해 결정**됨

### 4️⃣ 신뢰도 (Reliability)

**회선 상태**가 불안정할 경우 신뢰도 하락

각 링크의 **비트-에러율로 전송 손실이나 전송 에러에 대한 정보를 참조**해 신뢰성을 판단

- 신뢰도 값은 대부분 라우터에 의해 동적으로 **자동계산** but 관리자에 의해 수동 할당도 가능

### 5️⃣ 부하 (Load)

회선 사용량을 의미

- 정해진 회선 속도에서 **많은 사용자가 패킷을 전송**하게 되면 → 그만큼 다른 사용자가 사용할 수 있는 회선의 사용량이 적음
- 전송 매체에서 **네트워크 자원 사용량**을 나타내는 것 → 부하가 많이 발생하면 라우터의 CPU나 메모리의 많은 부담을 주게 됨
- 지연 시간이 짧더라도, 링크로 전송되는 패킷이 너무 많으면 체증 발생하여 지연 시간이 더 증가 → 부하 상황에 따라 라우팅 프로토콜이 부하정도를 주기적으로 비교하여 자원의 사용 경향 확인

### + 관리 거리(Administrative Distance)

관리거리값🔻 신뢰성🔼 우선순위🔼

모든 라우팅 프로토콜은 0 ~ 255 사이 **관리 거리 값**을 가지고 있음 → **값이 적을수록 신뢰성**이 높음

여러 개의 라우팅 프로토콜이 존재할 경우 → **관리거리 값이 낮은** 프로토콜로부터 받은 경로를 라우팅 테이블에 등록

- RIP(Routing Information Protocol: 거리 벡터)만 운영 → 홉 수가 적은 라우터 우선
- IGRP(Interior Gateway Routing Protocol: 내부 게이트웨이 프로토콜)만 운영 → 비용(Cost)이 적은 라우터 우선
- RIP, IGRP 동시 운영 시 → 관리 거리 값을 사용하여 결정

## ✅ 라우팅 프로토콜의 구성

### 1️⃣ Routing Table

- 패킷을 **목적지로 라우팅**할 때 **참조하는 테이블**
- 목적지 주소, Output interface, Metric값(목적지 이르는 최적경로를 결정하는데 사용되는 값)

### 2️⃣ Message

- 라우터 간 라우팅을 위해 교환하는 메시지
- 이웃 도달 메시지, 라우팅 정보

### 3️⃣ Metric

- Routing Table 생성 / 업데이트 시 최적의 경로를 결정하는 값
- 홉 수, 대역폭, 지연, 신뢰도, 부하, 경로 길이 등

## ✅ 라우팅 프로토콜의 종류

라우팅 프로토콜: 네트워크 정보의 생성, 교환을 제어하는 프로토콜

### ✔️ 정적(Static) 라우팅 프로토콜

네트워크 **관리자가 직접 목적지별로 네트워크 경로를 지정**하는 방식

- ✨ 데이터가 전달되는 경로를 관리자가 직접 제어해 → **안정성이 높음**
- ✨ **라우팅 테이블**을 **이해하기 쉬움**
- ✨ **라우터 부하 경감, 고속 라우팅** 가능
- 💩 라우터가 **많고 목적지가 많은 경우 설정이 어려움**
- 💩 장애가 발생했을 경우 **대처가 어려움** (정해진 경로 문제 발생 시 라우팅 불가능)
- 💩 네트워크 **변화가 심할 때 부적합**
- 💩 큰 네트워크에는 부적합
- 💩 관리자의 **관리부담 증가**

### ⭐ ✔️ 동적(Dynamic) 라우팅 프로토콜

**라우터가 스스로 라우팅 경로를 동적으로 결정**하여 → 네트워크 변화에 능동적으로 대처

라우팅 프로토콜을 통해 / 라우터 간 **경로 정보를 교환**해 → 최적의 경로를 설정

- ✨ 데이터가 전달되는 **경로를 자동으로 결정**
- ✨ **장애 발생 시 대처가 쉬움**
- ✨ **큰 네트워크에 적합**
- ✨ 다양한 경로 이용 가능
- 💩 설정 및 운영지식 습득 필요 → **관리자의 능력에 따라 안정적, 비안정적**이 결정됨
- 💩 데이터가 전달되는 경로를 관리자가 제어할 수 **없음**
- 💩 **안정성이 낮음 → 장애가 발생할 가능성**이 있음

> [!NOTE]
>
> 자동으로 경로 상태를 일정 주기마다 전달, 데이터를 저장하는 경로가 자동으로 결정된다. 자동으로 되기 때문에 관리자가 제어할 수 없음. ⭐ **자동으로 경로를 설정해주는 이점**

<br />

# 02 Routing Process

## ✅ 계층별 비교 OSI 7 Layer와 TCP/IP

## ✅ 3계층(네트워크 계층)에서 동작하는 라우터

두 개의 LAN이 연결 (Host-스위치-라우터가 하나의 LAN)

두 개 연결된 게 인터넷 망이다. (인터넷: 라우터와 라우터의 연결)

Host A → B 로 송신을 할 때 물리 계층까지 내려갔다가 스위치를 통하고 라우터 네트워크계층까지 올라갔다가 다시 라우터, 스위치를 통해 Host B로 전달됨

각 계층마다 규칙을 지켜야 함.

## ✅ 라우팅 테이블

목적지, 다음에 가야 할 라우터, 가는 데 비용을 표로 나타낸 것

- 1번 라우터: 갈 수 있는게 2, 4 두 경로로 갈 수 있음 cost가 싼 2번으로 감 next:2, cost:1
- 2번에 온 상태에서 3번을 간다고 해보자. cost가 싼 5로 이동하고, 3으로 이동

최소비용을 따짐

## ✅ ARP (Address Resolution Protocol; 주소 결정 프로토콜)

네트워크에서 IP주소를 **물리적 주소로 대응(bind)**시키는 기능

라우팅 테이블 동작과정

- ARP **요청은 브로드캐스트**로, **응답은 유니캐스트**로 저장

## ✅ Routing Process

1. 각 라우터별로 관리하는 **호스트IP**와 **MAC주소** 획득, **라우팅 테이블**
2. **라우팅 정보 교환**
3. **호스트와 라우터 사이 데이터링크** 링크,
   1번 라우터의 라우팅 테이블에서 **수신IP의 라우터 검색**
4. 호스트가 ARP(주소 결정 프로토콜)를 사용해 **수신자의 MAC 주소 파악**
   라우팅 테이블에 따라 라우팅
