# 01 관계형 데이터 모델

## ✅ 데이터 모델(data model)

- 현실 세계의 데이터를 명세하는 고유한 표현 방식
- 데이터 모델링을 위한 도구
- **데이터 모델의 3요소**
  - 1️⃣ **데이터 구조(data structure):** 구조적인 정적 특성
    - 데이터를 **어떤 형태로 저장**하는지를 표현하는 추상적 표현
    - 실제 저장 구조가 아닌, **개념상의 저장 구조**를 직관적으로 표현
  - 2️⃣ **연산(operation):** 행위적인 동적 특성
    - 개념적인 데이터 구조 안의 데이터를 어떤 방식으로 처리하는지를 표현
  - 3️⃣ **제약 조건(constraint)**
    - 데이터 구조 안에 데이터를 저장할 때의 **구조적 제약 사항** & 연산을 적용할 때의 **행위적 제약 사항**을 표현

### ✔️ 관계형 데이터 모델

- 테이블 형태의 **`릴레이션`**을 통해 데이터를 저장하고 + 데이터 간의 관련성도 표현
- **관계형 데이터 모델의 3요소**
  - 1️⃣ **릴레이션**: 데이터를 저장하는 기본 **데이터 구조**
  - 2️⃣ **관계 대수:** 릴레이션의 데이터를 처리하는 연산
  - 3️⃣ **무결성 제약 조건:** 제약사항

<br />

# 02 관계형 데이터 구조

- **관계형 데이터베이스(Relational Database)**: 관계형 데이터 모델에 기반
- **관계형 데이터 모델(Relational Data Model)**
  - 릴레이션으로 불리는 2차원 테이블 형태의 단순 구조에 데이터를 저장하는 방식
  - 테이블 구조는 릴레이션 개념을 직관적으로 쉽게 이해하도록 함
- **릴레이션(Relation)**
  - 관계형 데이터 모델의 핵심 요소로, 특별한 의미를 갖는 테이블
  - 단순 테이블처럼 보이지만, **테이블 이상의 많은 의미와 제약 사항**이 숨겨져 있음

고객 릴레이션의 카디널리티는 4, 차수는 6

## ✅ 릴레이션 관련 용어

### ✔️ 속성(attribute)

- 테이블의 **열(column)**
- 데이터를 표현하는 가장 작은 논리적 단위
  - 의미적으로 더이상 분해할 수 없는 원자 값(atomic value)만 사용
- 릴레이션이 표현하는 대상의 주요 특성들을 서로 다른 이름으로 구별하여 표현
- 속성 이름은 보통 각 도메인이 릴레이션에서 담당하는 역할(role)의 이름을 지정
  - 속성 이름은 도메인과 같은 이름을 사용할 수도 있고, 다른 이름으로 사용할 수도 있음
  - **도메인이 같더라도 속성 이름은 서로 달라야 함**

### ✔️ 투플(tuple)

- 테이블의 각 **행(row)**
- 현실의 개체(entity)를 표현
- 각 속성값(attribute value)들의 조합으로 구성
- 릴레이션에서 **하나의 투플은 개체 하나의 정보**를 표현

### ✔️ 도메인(domain)

- 각 **속성**이 취할 수 있는 **모든 값들의 집합**
- 데이터 값들의 유형과 크기, 범위
- 각 속성끼리 도메인이 일치할 경우에만 그 값을 서로 비교하는 것이 의미가 있음
- 관계형 데이터 모델은 **속성 이름과** **별개로 각 도메인을 고유한 이름으로 정의**

### ✔️ 카디널리티(cardinality)

- 릴레이션 안의 전체 **투플의 개수**
- 입력, 수정, 삭제 등을 통해 계속 변화 → 동적 특성

### ✔️ 차수(degree)

- 릴레이션을 구성하는 전체 **속성의 개수**
- 각 투플이 가지는 속성 값의 개수 == 차수
- 정적 특성

## ✅ 릴레이션의 구성 요소

릴레이션 스키마와 릴레이션 인스턴스 2가지 요소로 구성

### ✔️ 릴레이션 스키마(relation schema)

특정 릴레이션의 논리적 구조를 의미

- 릴레이션의 이름과 + 릴레이션 안에 포함된 모든 속성의 이름들로 정의
- 테이블의 첫 번째 행인 헤더 부분의 표현
- 릴레이션 내포(relation intension)라고도 부름
- 시간이 경과해도 좀처럼 변경되지 않는 정적인 특성
- 릴레이션 이름 뒤 소괄호 안에 릴레이션이 포함하는 속성들의 이름을 열거
  - `릴레이션이름(속성이름1, 속성이름2, …, 속성이름n)`

### ✔️ 릴레이션 인스턴스(relation instance)

어느 **한 시점에** 릴레이션에 존재하는 투플들의 집합

- 보통 헤더(테이블의 첫 번째 행)를 제외한 나머지 모든 행들의 집합으로 표현
- 릴레이션 외연(relation extension)이라고도 부름
- 특정 시점에서의 전체 투플들의 내용, 즉 릴레이션의 상태를 의미
- 시간에 따라 변하는 동적인 특성

## ✅ 데이터베이스 스키마, 데이터베이스 인스턴스

### ✔️ 데이터베이스 스키마(database schema)

릴레이션 스키마들의 모임 → **정적임**

### ✔️ 데이터베이스 인스턴스(database instance)

특정 시점에서의 모든 릴레이션 인스턴스들의 모임 → **동적임**

관계형 데이터베이스의 구성

## ✅ 릴레이션의 특성

### 1️⃣ 투플의 유일성

- 릴레이션 안에는 **똑같은 투플이 존재할 수 없음**
- 하나의 릴레이션은 투플들의 집합이기 때문에 → 모든 투플은 서로 달라야 함
- 모든 투플은 다른 투플과 구별되는 유일한 속성값이 있어야 함
  - 집합은 식별할 수 없는 똑같은 원소를 중복해서 포함할 수 없기 때문

### 2️⃣ 투플의 무순서성

- 릴레이션의 **투플 사이에 순서는 의미가 없음**
- 집합은 포함한 원소들 사이에 순서가 없음
- 투플의 집합인 릴레이션 역시 투플 사이에 순서를 갖지 않음

### 3️⃣ 속성의 무순서성(no ordering of attribute)

- 릴레이션의 속성 사이에 순서는 의미가 없음
- 릴레이션은 속성의 집합 → 같은 이유로 순서를 갖지 않음
- 속성 값은 속성의 순서가 아닌 **속성 이름에 의해 참조**됨

### 4️⃣ 속성의 원자성 (atomicity of attribute)

- 릴레이션을 구성하는 모든 속성 값은 의미적으로 더이상 분해할 수 없는 하나의 원자값만을 가짐
- 릴레이션은 다중 값 속성이나 복합 속성을 허용하지 않음
  - 각 속성값으로 / 의미적으로 더 쪼개서 사용할 수 있는 값이나 / 여러 개의 값이 허용되지 않음

<br />

# 03 제약 조건

구조적 제약 사항(릴레이션 저장) / 행위적 제약 사항 (관계대수)

## ✅ 릴레이션의 키(key)

- 각 **투플을 유일하게 식별**할 수 있는 하나 이상의 속성 집합
  - 릴레이션은 항상 투플의 유일성 규칙을 충족하므로 **중복 투플을 허용하지 않음**
  - 결과적으로 모든 투플은 속성 값이 하나 이상이 서로 다름
- **모든 릴레이션은 키**를 가짐
  - 키에 속하는 속성 집합은 / 반드시 그 속성값의 조합이 투플마다 달라야 함
- 키는 릴레이션이 단순한 테이블이 아님을 보여주는 대표적 개념
- 여러 무결성 제약 조건과 관련하여 중요한 역할을 함

### ✔️ 키 선정

- 현재의 릴레이션 데이터값만으로 결정하지 않아야 함
- 릴레이션 인스턴스는 계속 변화하므로 → 미래의 입력값까지를 포함한 / 속성의 본질적인 의미를 고려하여 키 지정 여부를 결정

### ✔️ 키 종류

후보키, 슈퍼키, 기본키, 대체키, 외래키 등

### 후보키(CK; Candidate Key)

투플을 **유일**하게 식별할 수 있는 속성들의 **최소** 집합

- **`유일성`**(uniqueness), **`최소성`**(minimality) 조건 모두 만족해야 함
  - **유일성 조건:** 릴레이션에서 키로 지정한 속성 값의 조합은 투플마다 모두 달라야 한다
  - **최소성 조건:** 릴레이션에서 키로 지정한 속성의 개수를 최소화해야 한다
    - 키 속성 중에서 속성을 하나라도 생략하면 → 투플을 유일하게 식별할 수 없게 되는, 꼭 필요한 최소한의 속성만으로 구성된 키
    - 둘 이상의 속성으로 이루어진 복합키(composite key)가 아니라면 최소성 조건은 항상 충족함
- 모든 릴레이션은 최소 하나 이상의 후보키를 가짐

### 슈퍼키(SK; Super Key)

투플을 **유일하게** 식별할 수 있는 속성 집합

- 식별을 위해 꼭 필요한 속성이 아니어도 포함할 수 있음
- 슈퍼키는 최소성 충족 여부는 관련 없고, 후보키의 **`유일성 조건`만** 만족하면 됨
- 릴레이션 안에는 여러 후보키가 있을 수 있고, 모든 후보키는 슈퍼키임
- 후보키를 포함하는 속성 집합도 모두 슈퍼키가 됨

### 기본키(PK; Primary Key)

**투플을 대표하도록 선정된 후보키**

- 여러 후보키 중에서 **하나를 기본키**로 선택하여 지정
- 의미적으로 투플을 가장 대표할 수 있고, **식별 수단으로도 적합한 후보키**를 기본키로 선정
- **기본키 선정 기준**
  - 후보키가 하나일 경우 → 바로 기본키가 됨
  - 후보키가 여러 개일 경우, 다음 기준을 충족하는 후보키를 우선적으로 고려
    - **값이 자주 변경되지 않는 정적인 속성**으로 구성된 후보키
    - **NULL값을 가질 수 없는 속성**으로 구성된 후보키
    - **속성 개수가 작은** 후보키
    - 속성값의 물리적 크기가 작은(숫자크기/문자열 길이 짧은) 후보키

### 대체키(AK; Alternate Key)

기본키로 선정되지 못한 후보키

- 릴레이션 안에서 기본키는 하나이지만, 대체키는 여러 개 존재 가능

### 외래키(FK; Foreign Key)

**특정 릴레이션의 기본키를 참조**하는 속성 집합

- 외래키 값은 / 참조되는 기본키 값 중에서 / 값 하나를 참조하여 취함
- 외래키 값은 동일한 값을 기본키 값으로 갖는 투플과의 관계를 표현
  - 기본키와 외래키는 릴레이션 간의 연관성을 표현
  - 의미적 연관성이 있음에도 다른 릴레이션으로 분리된 투플 사이의 연결고리 역할
- 릴레이션들 사이의 관계를 표현
  - 참조하는 릴레이션: 외래키를 가진 릴레이션
  - 참조되는 릴레이션: 외래키가 참조하는 기본키를 가진 릴레이션
- 외래키, 기본키 속성의 이름은 달라도 되지만, 도메인은 같아야 한다
- 하나의 릴레이션에 외래키가 여러 개 존재할 수 있고, 외래키를 기본키로 사용할 수도 있다
- 같은 릴레이션의 기본키를 참조하는 외래키도 정의 가능
- 외래키 속성은 NULL값을 가질 수 있음

## ✅ 무결성 제약 조건 (integrity constraint)

관계형 데이터 모델에서 / 릴레이션 안의 모든 데이터들을 / 의미적으로 흠 없이 항상 정확하고 완전한 상태로 유지하기 위해 / 적용해야 할 제약사항

- 데이터 무결성: 데이터의 일관성, 정확성에 손상이 없도록 유지되는 특성
- 데이터 무결성을 유지하는 2가지 구현 방식
  - 개별 응용 프로그램 안에 제약사항을 점검하는 코드를 추가해 구현
    - 💩 구현하기 부담스럽고 비효율적, 향후 유지하기도 어려움
  - DBMS 안의 무결성 제약 조건을 설정하여 구현
    - ✨ 별도 구현 없이 간단한 무결성 제약 조건 설정만으로 가능 → 부담 적고 효율적
    - ✨ DBMS는 이를 해석해 데이터를 입력, 수정, 삭제할 때마다 제약조건을 자동적으로 검사하여 적용시킴

### ✔️ **개체 무결성 제약조건 (entity integrity constraint)**

- **`기본키`** 제약 조건 (primary key constraint)
  - 기본키로 지정한 모든 속성은 NULL값을 가질 수 없음
  - 릴레이션 안에서 중복되지 않는 유일한 값을 가져야 함
- 기본키는 개체 식별자(entity identifier)의 역할
- 개체의 유일성을 선언하는 제약조건
- DBMS에게 기본키를 선언함으로써 **즉시 적용**

### ✔️ **참조 무결성 제약조건 (referential integrity constraint)**

- **`외래키`** 제약 조건 (foreign key constraint)
  - 외래키는 참조할 수 없는 값을 가질 수 없다.
  - 외래키로 지정한 속성은 참조하는 릴레이션의 기본키 속성 값과 일치하는 값이나 NULL값만을 가져야 함
- 외래키는 개체 참조자(entity referer)의 역할
- 개체의 참조 관계를 선언하는 제약조건
- DBMS에게 외래키를 선언함으로써 즉시 적용
- 의미적으로 연관된 두 릴레이션 투플 사이의 일관성 유지를 위해 사용

### ✔️ 도메인 무결성 제약조건 (domain integrity constraint)

투플의 모든 속성 값이 **각 속성의 도메인에 속한 값만을 취해야** 한다는 제약 사항

- SQL의 `CREATE TABLE` 명령문 작성 시 각 열의 타입, `NULL`/`NOT NULL`, `DEFAULT`, `CHECK` 등의 키워드 설정을 통해 DBMS에게 지시

### ✔️ 유일성 제약조건 (uniqueness constraint) / 키 제약 조건 (key constraint)

**모든 키 속성값이 서로 중복되지 않고 유일**해야 한다는 제약사항

- 대체키와 밀접한 연관성이 있음
- SQL의 `CREATE TABLE` 명령문 작성 시 `UNIQUE` 키워드 설정을 통해 DBMS에게 지시

<br />

# 04 관계 연산 (relation operation)

- 관계형 데이터 모델에서 **릴레이션을 조작하기 위한 연산**
- 관계형 DB 언어의 명세 형식이나 내부 처리 과정과 연관

## 관계 연산의 대표적인 표현 방법

### 1️⃣ **관계 대수(relation algebra)**

- 사용자가 필요로 하는 데이터를 획득하는 절차
- **연산들의 적용 순서**를 명세
- 실행 순서를 순차적으로 명세하는 **절차적(procedural) 표현** 방법
- 어떻게(HOW)에 중점
- 관계 연산의 기본 토대를 제공 + 관계형 표준 DB 언어인 SQL에 반영 + DBMS가 내부적으로 질의를 구현하고 최적화하기 위한 기반으로 사용

### 2️⃣ **관계 해석(relational calculus)**

- 사용자가 필요한 데이터가 무엇인지, 연산들의 **최종 결과만**을 명세
- 선언적(declarative) 표현 방법, 비절차적(nonprocedural) 표현 방법
- 무엇을(WHAT)에 중점

### 관계 대수와 관계 해석

- 둘 다 기능이나 표현력은 동등함
- 둘 다 형식 언어로서 상용 DBMS가 직접 지원하지 않으므로 실제 사용할 수 있는 데이터 언어는 아님
- SQL 언어의 작성 방법이나 내부 처리 방식의 이론적 기반을 제공
